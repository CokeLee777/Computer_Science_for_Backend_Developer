## Transaction

### 트랜잭션(Transaction)이란 무엇인가?

트랜잭션은 작업의 완전성을 보장해주는 것이다. 즉, 논리적인 작업들이 모두 완벽하게 처리된다면 상관이 없지만, 완벽하게 처리하지 못할 경우 원 상태로 복구해서 작업의 일부만 적용되는 현상이 발생하지 않게 만들어준다. 각각의 입장에서는 트랜잭션은 다음과 같이 정의할 수 있다.

- 사용자 입장: 논리적인 작업 단위
- 시스템 입장: 데이터를 접근 또는 변경하는 프로그램의 단위

### 트랜잭션의 특징

트랜잭션은 반드시 다음 4가지 특성(ACID)을 만족해야 한다.

#### 원자성(Atomicity)

트랜잭션은 모두 성공하거나 모두 실패해야 한다. 즉, 트랜잭션 중간에 어떤 문제가 발생하여 한 작업에 문제가 생길경우 모두 원 상태로 복구해야 하고, 아니라면 모두 반영되어야 한다.

> 항공 티켓 주문을 원자성의 예시로 들 수 있다. 티켓은 반드시 지불과 동시에 좌석 예약이 되거나 아니면 모두 되지 않아야 할 것이다. 티켓 값만 지불하고 좌석 예약이 되지 않는 경우는 허용되지 않는다는 것이다.

#### 일관성(Consistency)

트랜잭션이 완료된 상태와 트랜잭션이 일어나기 전의 상태는 데이터의 일관성을 보장해야 한다. 즉, 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 유지하는 것을 의미한다.

>  친구한테 계좌 송금을 하는 것을 예시로 들 수 있다. 송금을 하기 위해서는 계좌에 0원보다 많은 돈이 있어야한다. 만약 내 계좌에 돈이 1000원이 있는데 친구한테 1001원을 송금할 수 없을 것이다. 즉, 내 통장은 일관성을 지키기 때문에 송금이 불가능한 것이다. 송금하기 전의 통장은 0원이상이 필요하고 송금 후에도 0원이상 남아있어야 한다는 것을 의미한다.

#### 고립성(Isolation)

트랜잭션을 수행 시 다른 트랜잭션의 연산 작업이 끼어들지 못하도록 보장하는 것을 의미한다. 이것은 트랜잭션 밖에 있는 어떤 연산도 중간 단계의 데이터를 볼 수 없음을 의미한다.

> 만약 일하거나 공부를 하는 도중에 다른 사람이 말을 건다고 생각을 해보면 집중력을 잃어버릴 것이다. 이것은 데이터베이스도 마찬가지이다. 작업을 하는 도중에 다른 작업이 끼어든다면 성능이 안좋아질 것이다. 성능관련 이유로 인해 이 특성은 가장 유연성 있는 제약조건이라고 볼 수 있다.

#### 지속성(Durability)

성공적으로 수행된 트랜잭션은 영구적으로 데이터베이스에 작업 결과가 반영되어야 한다.

> 우리가 문서를 작성하고 저장한 다음 다시 문서를 키면 저장버튼을 누르고 껐기 때문에 데이터가 보존되어있다. 하지만 저장버튼을 누르지 않고 문서를 껐다 키면 데이터가 보존되어있지 않을 것이다.
